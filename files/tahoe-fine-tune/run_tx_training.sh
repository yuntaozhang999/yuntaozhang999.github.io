uv run state tx train \
 data.kwargs.toml_config_path=/home/ustbz/prepare_instance/starter.toml \
 data.kwargs.num_workers=6 \
 data.kwargs.batch_col=batch_var \
 data.kwargs.pert_col=target_gene \
 data.kwargs.cell_type_key=cell_type \
 data.kwargs.control_pert=non-targeting \
 data.kwargs.pert_rep=features \
 data.kwargs.perturbation_features_file=/home/ustbz/competition_support_set/ESM2_pert_features.pt \
 data.kwargs.pin_memory=true \
 +data.kwargs.persistent_workers=true \
 +data.kwargs.prefetch_factor=6 \
 model=tahoe-finetune-yuntao0912 \
 +model.kwargs.freeze_pert_backbone=false \
 training.batch_size=12 \
 training.max_steps=40000 \
 training.ckpt_every_n_steps=2000 \
 training.val_freq=500 \
 +training.precision=bf16-mixed \
 +training.flops.use_backward=false \
 training.lr=3e-5 \
 +training.lr_scheduler=cosine \
 +training.lr_num_cycles=1 \
 +training.min_lr_ratio=0.1 \
 +training.log_lr=true \
 training.gradient_clip_val=1.0 \
 +training.accumulate_grad_batches=8 \
 training.weight_decay=1e-3 \
 use_wandb=true \
 wandb.entity=yuntaozhang999-personal \
 wandb.project=lightning_logs \
 wandb.tags=[tahoe-finetune-yuntao0912] \
 output_dir=/home/ustbz \
 name=tahoe-finetune-yuntao0912
